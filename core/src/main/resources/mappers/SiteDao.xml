<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.go2plus.core.product.dao.SiteDao">
	<resultMap id="siteResult" type="Site">
			<id property="id" column="id" javaType="Integer"/>
				<result property="userId"  column="user_id"	javaType="Integer"/>
				<result property="subdomain"  column="subdomain"	javaType="String"/>
				<result property="state"  column="state"	javaType="Integer"/>
				<result property="createTime"  column="create_time"	javaType="Date"/>
				<result property="updateTime"  column="update_time"	javaType="Date"/>
			</resultMap>
	
	
	<sql id="querySiteSql">
      	<where>
      	<![CDATA[
			1=1
		 ]]>
						<if test="id!=null">
			<![CDATA[
				and T.id=#{id}
			]]>
		</if>
								<if test="userId!=null">
			<![CDATA[
				and T.user_id=#{userId}
			]]>
		</if>
								<if test="subdomain!=null">
			<![CDATA[
				and T.subdomain=#{subdomain}
			]]>
		</if>
								<if test="state!=null">
			<![CDATA[
				and T.state=#{state}
			]]>
		</if>
								<if test="createTime!=null">
			<![CDATA[
				and T.create_time=#{createTime}
			]]>
		</if>
								<if test="updateTime!=null">
			<![CDATA[
				and T.update_time=#{updateTime}
			]]>
		</if>
				    	</where>
   </sql>
   
   
	<select id="findById" resultMap="siteResult" parameterType="long">
		<![CDATA[
		SELECT
		*
		FROM site WHERE id=#{id}
		]]>
	</select>
	
	<select id="findPageList" resultMap="siteResult" parameterType="map">
		<![CDATA[
			SELECT T.* FROM site T T
    	]]>
    	<include refid="querySiteSql"/>
    	<![CDATA[
		   ORDER BY T.id DESC limit ${startNum},${endNum}
		]]>
        
	</select>
	
	<select id="findCount" resultType="int" parameterType="map">
		<![CDATA[
        	SELECT COUNT(1) FROM site T
    	]]>
    	<include refid="querySiteSql"/>
	</select>
  
  <select id="findSiteBySubdomain" resultType="java.lang.String">
      select subdomain from site where subdomain=#{url} limit 1
  </select>
	
	<insert id="insert" parameterType="Site" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			INSERT INTO site(
						user_id,
						subdomain,
						state,
						create_time,
						update_time
						)VALUES(
								#{userId},
								#{subdomain},
								#{state},
								#{createTime},
								#{updateTime}
							)
		]]>
	</insert>
	
	<update id="update" parameterType="Site">
		<![CDATA[
			UPDATE site SET
												user_id=#{userId},
												subdomain=#{subdomain},
												state=#{state},
												create_time=#{createTime},
												update_time=#{updateTime}
								WHERE id=#{id}
		]]>
	</update>
	
	<delete id="delete" parameterType="long">
		<![CDATA[
			DELETE FROM site WHERE id=#{id}
		]]>
	</delete>
</mapper>
